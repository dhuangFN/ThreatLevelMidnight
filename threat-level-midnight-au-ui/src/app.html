<template>
  <require from="./resources/external/vv-components.style.css"></require>  
  <div class="p-4">
  <h1>Threat Level Midnight</h1>
  <vv-card class="w-1/2 ml-4 mb-4">
    <vv-card-header>Content</vv-card-header>
    <vv-card-body>
      <vv-textarea placeholder="Paste the content you would like to threat check here..." class="w-full block" name="prompt" value.two-way="prompt"></vv-textarea>
    </vv-card-body>
    <vv-card-footer>
      <vv-button type="primary" class="inline float-right mb-2" click.trigger="assessThreat()">Submit</vv-button>
    </vv-card-footer>
  </vv-card>

  <vv-button if.bind="history && history.length" type="secondary" class="inline-block ml-2 mb-2" click.trigger="clearHistory()">Clear History</vv-button>
  <vv-card if.bind="isLoading" class="w-1/2 ml-4 mb-4">
    <vv-card-header>
      <div if.bind="isLoading" class="w-28">Loading...         
        <vv-spinner-loader class="float-right mt-1"></vv-spinner-loader>
      </div>
    </vv-card-header>
    <vv-card-body>
      <div if.bind="isLoading" class="w-full">
        <vv-skeleton-loader class="h-8 p-2 mb-1 w-28"></vv-skeleton-loader>
        <vv-skeleton-loader class="h-8 p-2 mb-1 w-1/3"></vv-skeleton-loader>
        <vv-skeleton-loader class="h-8 p-2 mb-1 w-40"></vv-skeleton-loader>
      </div>
    </vv-card-body>
  </vv-card>

  <vv-card repeat.for="item of history" class="w-1/2 ml-4 mb-4">
    <vv-card-header>Result
    </vv-card-header>
    <vv-card-body>
      <div>
        <p>Content: <span class="text-fn-purple italic">${item.content}</span> </p>
        <hr class="mb-2" />
        <p if.bind="isImminentThreat(item)">
          <img src="../static/threat-level-midnight.gif" />
        </p>
        <p>Threat: ${item.result["threat-rating"]}</p>
        <p>Reason: ${item.result.reason}</p>
        <p>Sentiment: ${item.result.sentiment}</p>
      </div>
    </vv-card-body>
    <vv-card-footer>
    </vv-card-footer>
  </vv-card>

</div>
</template>
